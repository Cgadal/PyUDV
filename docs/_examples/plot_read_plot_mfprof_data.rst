
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "_examples/plot_read_plot_mfprof_data.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download__examples_plot_read_plot_mfprof_data.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr__examples_plot_read_plot_mfprof_data.py:


==========================
Read and plot .mfprof data
==========================

.. GENERATED FROM PYTHON SOURCE LINES 6-70



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /_examples/images/sphx_glr_plot_read_plot_mfprof_data_001.png
         :alt: plot read plot mfprof data
         :srcset: /_examples/images/sphx_glr_plot_read_plot_mfprof_data_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /_examples/images/sphx_glr_plot_read_plot_mfprof_data_002.png
         :alt: plot read plot mfprof data
         :srcset: /_examples/images/sphx_glr_plot_read_plot_mfprof_data_002.png
         :class: sphx-glr-multi-img





.. code-block:: default


    import matplotlib.colors as colors
    import matplotlib.pyplot as plt
    import numpy as np

    from pyudv.read_mfprof import (
        amplitude_from_mfprof_reading,
        read_mfprof,
        velocity_from_mfprof_reading,
    )

    #
    path_data = "src/data_sample.mfprof"

    # #### Loading data
    Data, Parameters, Info, Units = read_mfprof(path_data)
    Amplitude_data = amplitude_from_mfprof_reading(Data, Parameters)
    Velocity_data = velocity_from_mfprof_reading(Data, Parameters)
    time = Data["profileTime"]
    z_coordinates = Data["DistanceAlongBeam"] * 1e2
    indmax_time = np.argwhere(Data["transducer"] == 0)[1][0] - 1
    indmax_z = -1
    ind_bottom = 572

    # #### plotting velocity
    divnorm = colors.TwoSlopeNorm(vcenter=0, vmin=-0.2, vmax=0.2)
    fig, ax = plt.subplots(1, 1, constrained_layout=True)
    c = ax.pcolormesh(
        time[:indmax_time],
        z_coordinates[:indmax_z],
        Velocity_data[:indmax_z, :indmax_time],
        cmap="PuOr",
        norm=divnorm,
        rasterized=True,
        shading="auto",
    )
    ax.axhline(y=z_coordinates[ind_bottom], color="k", lw="0.5", ls="--")
    ax.invert_yaxis()
    fig.colorbar(c, label="Velocity [m/s]")
    ax.set_xlabel("Time [s]")
    ax.set_ylabel("DistanceAlongBeam [cm]")
    # fig.draw_without_rendering()
    plt.savefig("plots/Spatio_temporal_velocity.pdf", dpi=600)
    plt.show()

    # #### plotting amplitude
    divnorm = colors.TwoSlopeNorm(vcenter=0, vmin=-0.1, vmax=0.1)
    fig, ax = plt.subplots(1, 1, constrained_layout=True)
    c = ax.pcolormesh(
        time[:indmax_time],
        z_coordinates[:indmax_z],
        Amplitude_data[:indmax_z, :indmax_time],
        rasterized=True,
        shading="auto",
        cmap="PuOr",
        norm=divnorm,
    )
    ax.axhline(y=z_coordinates[ind_bottom], color="k", lw="0.5", ls="--")
    ax.invert_yaxis()
    fig.colorbar(c, label="Amplitude [V]")
    ax.set_xlabel("Time [s]")
    ax.set_ylabel("DistanceAlongBeam [cm]")
    plt.savefig("plots/Spatio_temporal_amplitude.pdf", dpi=600)
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  3.690 seconds)


.. _sphx_glr_download__examples_plot_read_plot_mfprof_data.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_read_plot_mfprof_data.py <plot_read_plot_mfprof_data.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_read_plot_mfprof_data.ipynb <plot_read_plot_mfprof_data.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
